refer to : https://gist.github.com/Soarez/9688998

===Part I: Key
1. generate rsa private key:
openssl genrsa -out eyaweiw.cn.key 2048

The out put is:
eyaweiw.cn.key

2. inspect the private key: 
openssl rsa -in eyaweiw.cn.key -noout -text

3. extract the public key from private key:
openssl rsa -in eyaweiw.cn.key -pubout -out eyaweiw.cn.pubkey

The output is:
eyaweiw.cn.pubkey
 
4. show the public key content:
openssl rsa -in eyaweiw.cn.pubkey -pubin -noout -text

5. generate a Certificate Signing Request based on the private key: (the CSR is signed by the private key)
openssl req -new -key eyaweiw.cn.key -out eyaweiw.cn.csr 

The output is:
eyaweiw.cn.csr

6. inspect the CSR file:
openssl req -in eyaweiw.cn.csr -noout -text

7. Another way to generate the private key and CSR with config file is: (optiona, just test)
openssl req -new -out easystogu.csr -config easystogu.csr.config

The output is:
easystogu.csr

===Part II: self signed CA
8. generate a scef signed private key and certificate with pem format:(optional, just test)
openssl req -x509 -sha256 -nodes -newkey rsa:2048 -keyout albertyang.selfsigned.key -out albertyang.selfsigned.cert.pem

The output is:
albertyang.selfsigned.key
albertyang.selfsigned.cert.pem

9. generate a scefsigned certificate from a private key: (The input private key is generated by step 1)
openssl req -new -x509 -key eyaweiw.cn.key -out eyaweiw.cn.selfsign.crt

The output is:
eyaweiw.cn.selfsign.crt

===Part III: CA Key and self-signed Certificate
10. generate CA private key:
openssl genrsa -out ca.key 2048

The output is:
ca.key

11. Generate a self signed certificate for the CA:
openssl req -new -x509 -key ca.key -out ca.crt

The output is:
ca.crt

12. Sign a request certificate using the CA private key: (The request CSR is generated by step 5)
openssl x509 -req -in eyaweiw.cn.csr -CA ca.crt -CAkey ca.key -CAcreateserial -out eyaweiw.cn.CAsign.crt

The output is:
eyaweiw.cn.CAsign.crt
ca.srl (serial number sign by CA)

13. Inspect the certificate:
openssl x509 -in eyaweiw.cn.CAsign.crt -noout -text

===Part IV: sign a request using the CA config file:
14. Sign a request using the ca.conf file:
mkdir newcerts
touch index.txt
echo '01' > serial

openssl ca -config ca.conf -out eyaweiw.cn.CAsignWithConf.crt -infiles eyaweiw.cn.csr

The output is:
eyaweiw.cn.CAsignWithConf.crt
./newcerts/01.pem
index.txt
index.txt.attr

15. Inspect the CA sign certificate:
openssl x509 -in eyaweiw.cn.CAsignWithConf.crt -noout -text

16. Sign a request using the ca.conf and extersion conif file:
openssl ca -config ca.conf -out eyaweiw.cn.CAsignWithExtConf.crt -extfile easystogu.extensions.conf -infiles eyaweiw.cn.csr

The output is:
eyaweiw.cn.CAsignWithExtConf.crt

16. bundle the two certification files:
cat eyaweiw.cn.CAsignWithConf.crt ca.crt > bundle.crt

The output is:
bundle.crt
